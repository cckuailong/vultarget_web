{"version":3,"sources":["webpack:///./src/views/scene/index.vue?5c21","webpack:///./src/views/scene/index.vue?9d01","webpack:///./src/api/scene.js","webpack:///src/views/scene/index.vue","webpack:///./src/views/scene/index.vue?08cf","webpack:///./src/views/scene/index.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","directives","name","rawName","value","expression","loadingText","slot","_v","isRun","_e","staticStyle","_s","layout","desc","_l","item","i","currentScore","currentProgress","currentRank","model","callback","$$v","flag","on","handleFlag","isAdmin","handleRun","handleStop","rankList","computeTableIndex","page","size","total","handleRank","staticRenderFns","sceneGet","layoutId","request","url","method","sceneStart","sceneStop","sceneFlag","sceneRank","undefined","data","id","loadingFlag","open","computed","created","roles","length","initModelInfo","methods","$message","message","type","$router","push","then","status","msg","rsp","console","log","index","component"],"mappings":"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","file":"static/js/chunk-b7fe23c0.cc28311a.js","sourcesContent":["export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&id=f71d8ed6&scoped=true&lang=css&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"app-container\"},[_c('el-row',[_c('el-col',{attrs:{\"span\":11}},[_c('el-card',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.loadingFlag),expression:\"loadingFlag\"}],attrs:{\"element-loading-text\":_vm.loadingText}},[_c('div',{staticClass:\"clearfix\",attrs:{\"slot\":\"header\"},slot:\"header\"},[_c('span',[_vm._v(\"场景信息\")]),_vm._v(\" \"),(!_vm.isRun)?_c('el-tooltip',{attrs:{\"content\":\"运行中\"}},[_c('i',{staticClass:\"el-icon-loading\",staticStyle:{\"color\":\"#20a0ff\"}})]):_vm._e(),_vm._v(\" \"),(_vm.isRun)?_c('el-tooltip',{attrs:{\"content\":\"未启动\"}},[_c('i',{staticClass:\"fa fa-stop\",attrs:{\"aria-hidden\":\"true\"}})]):_vm._e()],1),_vm._v(\" \"),_c('div',[_c('div',{staticClass:\"text item\"},[_vm._v(\"\\n            环境名称：\"+_vm._s(_vm.layout.name)+\"\\n          \")]),_vm._v(\" \"),_c('div',{staticClass:\"text item\"},[_vm._v(\"\\n            环境描述：\"+_vm._s(_vm.layout.desc)+\"\\n          \")]),_vm._v(\" \"),_c('div',{staticClass:\"text item\"},[_vm._v(\"\\n            访问地址：\\n            \"),_vm._l((_vm.open),function(item,i){return _c('p',[_vm._v(\"\\n              \"+_vm._s(item)+\"\\n            \")])})],2),_vm._v(\" \"),_c('div',{staticClass:\"text item\"},[_vm._v(\"\\n            当前分数：\"+_vm._s(_vm.currentScore)+\"\\n          \")]),_vm._v(\" \"),_c('div',{staticClass:\"text item\"},[_vm._v(\"\\n            当前进度：\"+_vm._s(_vm.currentProgress)+\"\\n          \")]),_vm._v(\" \"),_c('div',{staticClass:\"text item\"},[_vm._v(\"\\n            当前排名：\\n            \"),(_vm.currentRank === 0)?_c('span',[_vm._v(\"\\n              未上榜\\n            \")]):(_vm.currentRank > 0)?_c('span',[_vm._v(\"\\n              \"+_vm._s(_vm.currentRank)+\"\\n            \")]):_vm._e()]),_vm._v(\" \"),_c('el-form',[_c('el-form-item',{attrs:{\"label\":\"Flag\"}},[_c('el-input',{staticStyle:{\"width\":\"80%\"},attrs:{\"disabled\":_vm.isRun,\"size\":\"small\",\"placeholder\":\"请输入Flag：格式flag-{xxxxxxxx}\"},model:{value:(_vm.flag),callback:function ($$v) {_vm.flag=$$v},expression:\"flag\"}})],1),_vm._v(\" \"),_c('el-form-item',[_c('el-button',{attrs:{\"size\":\"small\",\"disabled\":_vm.isRun,\"type\":\"primary\"},on:{\"click\":_vm.handleFlag}},[_vm._v(\"提交\")]),_vm._v(\" \"),(_vm.isAdmin===true && _vm.isRun)?_c('el-button',{attrs:{\"size\":\"small\",\"type\":\"primary\"},on:{\"click\":_vm.handleRun}},[_vm._v(\"启动\")]):_vm._e(),_vm._v(\" \"),(_vm.isAdmin===true && !_vm.isRun)?_c('el-button',{attrs:{\"size\":\"small\",\"type\":\"primary\"},on:{\"click\":_vm.handleStop}},[_vm._v(\"停止\")]):_vm._e()],1)],1)],1)])],1),_vm._v(\" \"),_c('el-col',{attrs:{\"span\":12,\"offset\":1}},[_c('el-card',[_c('div',{staticClass:\"clearfix\",attrs:{\"slot\":\"header\"},slot:\"header\"},[_c('span',[_vm._v(\"排名\")])]),_vm._v(\" \"),_c('div',[_c('el-table',{attrs:{\"data\":_vm.rankList}},[_c('el-table-column',{attrs:{\"label\":\"序号\",\"type\":\"index\",\"index\":_vm.computeTableIndex,\"width\":\"50\"}}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"prop\":\"username\",\"show-overflow-tooltip\":true,\"label\":\"用户名\"}}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"prop\":\"score\",\"label\":\"积分\",\"width\":\"180\"}})],1)],1),_vm._v(\" \"),_c('div',{staticStyle:{\"margin-top\":\"20px\"}},[_c('el-pagination',{attrs:{\"page-size\":_vm.page.size,\"layout\":\"total, prev, pager, next, jumper\",\"total\":_vm.page.total},on:{\"current-change\":_vm.handleRank}})],1)])],1)],1),_vm._v(\" \"),_c('div')],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import request from '@/utils/request'\n\n/**\n * 获取信息\n * @param layoutId\n * @returns\n */\nexport function sceneGet(layoutId){\n  return request({\n    url: '/layout/'+layoutId+'/get/',\n    method: 'get'\n  })\n}\n\n/**\n * 启动模式\n * @param layoutId 环境ID\n * @returns\n */\nexport function sceneStart(layoutId){\n  return request({\n    url: '/layout/'+layoutId+'/start/',\n    method: 'get'\n  })\n}\n\n/**\n * 关闭模式\n * @param layoutId\n * @returns {AxiosPromise}\n */\nexport function sceneStop(layoutId){\n  return request({\n    url: '/layout/'+layoutId+'/stop/',\n    method: 'get'\n  })\n}\n\n/**\n * 提交Flag\n * @param layoutId layoutId\n * @param flag flag\n * @returns\n */\nexport function sceneFlag(layoutId, flag){\n  return request({\n    url: '/layout/'+layoutId+'/flag/?flag='+flag,\n    method: 'get'\n  })\n}\n\n/**\n * 排名\n * @param layoutId\n * @returns\n */\nexport function sceneRank(layoutId,page){\n  if (page === undefined || page === null || page < 1){\n    page = 1\n  }\n  return request({\n    url: '/layout/'+layoutId+'/rank/?page='+page,\n    method: 'get'\n  })\n}\n","<template>\n<div class=\"app-container\">\n  <el-row>\n    <el-col :span=\"11\">\n      <el-card v-loading=\"loadingFlag\" :element-loading-text=\"loadingText\">\n        <div slot=\"header\" class=\"clearfix\">\n          <span>场景信息</span>\n          <el-tooltip v-if=\"!isRun\" content=\"运行中\">\n            <i style=\"color: #20a0ff;\" class=\"el-icon-loading\"></i>\n          </el-tooltip>\n          <el-tooltip v-if=\"isRun\" content=\"未启动\">\n            <i class=\"fa fa-stop\" aria-hidden=\"true\"></i>\n          </el-tooltip>\n        </div>\n        <div>\n          <div class=\"text item\">\n            环境名称：{{layout.name}}\n          </div>\n          <div class=\"text item\">\n            环境描述：{{layout.desc}}\n          </div>\n          <div class=\"text item\" >\n            访问地址：\n            <p v-for=\"(item,i) in open\" >\n              {{item}}\n            </p>\n          </div>\n          <div class=\"text item\">\n            当前分数：{{currentScore}}\n          </div>\n          <div class=\"text item\">\n            当前进度：{{currentProgress}}\n          </div>\n          <div class=\"text item\">\n            当前排名：\n            <span v-if=\"currentRank === 0\" >\n              未上榜\n            </span>\n            <span v-else-if=\"currentRank > 0\" >\n              {{currentRank}}\n            </span>\n          </div>\n          <el-form >\n            <el-form-item label=\"Flag\">\n              <el-input :disabled=\"isRun\" size=\"small\" style=\"width: 80%\" v-model=\"flag\" placeholder=\"请输入Flag：格式flag-{xxxxxxxx}\"></el-input>\n            </el-form-item>\n            <el-form-item>\n              <el-button size=\"small\" :disabled=\"isRun\" type=\"primary\" @click=\"handleFlag\">提交</el-button>\n              <el-button v-if=\"isAdmin===true && isRun\" size=\"small\" @click=\"handleRun\" type=\"primary\">启动</el-button>\n              <el-button v-if=\"isAdmin===true && !isRun\" size=\"small\" @click=\"handleStop\" type=\"primary\">停止</el-button>\n            </el-form-item>\n          </el-form>\n        </div>\n      </el-card>\n    </el-col>\n    <el-col :span=\"12\" :offset=\"1\">\n      <el-card>\n        <div slot=\"header\" class=\"clearfix\">\n          <span>排名</span>\n        </div>\n        <div>\n          <el-table :data=\"rankList\">\n            <el-table-column label=\"序号\" type=\"index\" :index=\"computeTableIndex\" width=\"50\"></el-table-column>\n            <el-table-column prop=\"username\" :show-overflow-tooltip=true label=\"用户名\"></el-table-column>\n            <el-table-column prop=\"score\" label=\"积分\" width=\"180\"></el-table-column>\n          </el-table>\n        </div>\n        <div style=\"margin-top: 20px\">\n          <el-pagination\n            :page-size=\"page.size\"\n            @current-change=\"handleRank\"\n            layout=\"total, prev, pager, next, jumper\"\n            :total=\"page.total\">\n          </el-pagination>\n        </div>\n      </el-card>\n    </el-col>\n  </el-row>\n  <div>\n\n  </div>\n</div>\n</template>\n\n<script>\n\nimport { mapGetters } from 'vuex'\nimport {sceneGet, sceneStart, sceneStop,sceneFlag, sceneRank} from '@/api/scene'\n\nexport default {\n  name: 'index.vue',\n  data(){\n    return {\n      layout: {\n        id: \"\",\n        name: \"\",\n        desc: \"\",\n      },\n      loadingFlag: true,\n      loadingText: \"环境启动中\",\n      flag: \"\",\n      isAdmin: false,\n      page:{\n        total: 0,\n        size: 20,\n        page: 1\n      },\n      isRun: false,\n      currentProgress: \"\",\n      currentRank: 0,\n      currentScore: 0,\n      open: [],\n      rankList:[]\n    }\n  },\n  computed: {\n    ...mapGetters([\n      'name',\n      'avatar',\n      'roles',\n      'rank'\n    ])\n  },\n  created() {\n    if (this.roles.length >0 &&this.roles[0] === \"admin\"){\n      this.isAdmin = true\n    }\n    this.initModelInfo()\n    this.handleRank(1)\n  },\n  methods:{\n    /**\n     * 初始化模式信息\n     */\n    initModelInfo(){\n      this.loadingText = \"模式信息初始化中\"\n      this.loadingFlag = true\n      // 环境 id\n      let layoutId = this.$route.query.layout_id\n      if (layoutId === undefined || layoutId == null || layoutId === \"\"){\n        this.$message({\n          message: \"参数不能为空\",\n          type: \"error\",\n        })\n        this.$router.push({path: \"/scene/list\"})\n      }\n      this.layout.id = layoutId\n      sceneGet(layoutId).then(response=>{\n        this.loadingFlag = false\n        let rsp = response.data\n        let status = rsp.status\n        let msg = rsp.msg\n        if (status === 200){\n          this.layout.name = rsp.data[\"layout\"][\"name\"]\n          this.layout.desc = rsp.data[\"layout\"][\"desc\"]\n          this.open = rsp.data[\"open\"]\n          if(!rsp.data[\"is_run\"]){\n            this.isRun = true\n          }\n        }else{\n          this.$message({\n            message: msg,\n            type: \"error\",\n          })\n        }\n      }).catch(err => {\n        this.loadingFlag = false\n        this.$message({\n          message: \"服务器内部错误\",\n          type: \"error\",\n        })\n        this.$router.push({path: \"/scene/list\"})\n      })\n    },\n    /**\n     * 启动\n     */\n    handleRun(){\n      this.loadingFlag = true\n      this.loadingText= \"模式启动中\"\n      let layoutId = this.layout.id\n      if (layoutId === undefined || layoutId == null || layoutId === \"\"){\n        this.$message({\n          message: \"参数不能为空\",\n          type: \"error\",\n        })\n        this.$router.push({path: \"/scene/list\"})\n      }\n      sceneStart(layoutId).then(response => {\n        this.loadingFlag = false\n        let rsp = response.data\n        let status = rsp.status\n        let msg = rsp.msg\n        if (status === 200){\n          this.layout.name = rsp.data[\"layout\"][\"name\"]\n          this.layout.desc = rsp.data[\"layout\"][\"desc\"]\n          this.open = rsp.data[\"open\"]\n          if (undefined === rsp.data[\"is_run\"]){\n            rsp.data[\"is_run\"] = true\n          }\n          this.isRun = !rsp.data[\"is_run\"]\n          console.log(this.isRun)\n          this.$message({\n            message: \"启动成功\",\n            type: 'success'\n          })\n        }else{\n          this.$message({\n            message: msg,\n            type: \"error\",\n          })\n        }\n      }).catch(err => {\n        this.loadingFlag = false\n        this.$message({\n          message: \"服务器内部错误\",\n          type: \"error\",\n        })\n        this.$router.push({path: \"/scene/list\"})\n      })\n    },\n    /**\n     * 停止\n     */\n    handleStop(){\n      this.loadingFlag = true\n      this.loadingText = \"模式停止中\"\n      let layoutId = this.layout.id\n      if (layoutId === undefined || layoutId == null || layoutId === \"\"){\n        this.$message({\n          message: \"参数不能为空\",\n          type: \"error\",\n        })\n        this.$router.push({path: \"/scene/list\"})\n      }\n      sceneStop(layoutId).then(response => {\n        this.loadingFlag = false\n        let rsp = response.data\n        let status = rsp.status\n        let msg = rsp.msg\n        if (status === 200){\n          this.$message({\n            message: \"关闭成功\",\n            type: 'success'\n          })\n          this.initModelInfo()\n        }else{\n          this.$message({\n            message: msg,\n            type: \"error\",\n          })\n        }\n      }).catch(err => {\n        this.loadingFlag = false\n        this.$message({\n          message: \"服务器内部错误\",\n          type: \"error\",\n        })\n      })\n      // this.loadingFlag = false\n    },\n    /**\n     * 提交flag\n     */\n    handleFlag(){\n      let flag = this.flag\n      this.loadingFlag = true\n      this.loadingText = \"Flag 提交中\"\n      if (flag === \"\" || flag === null){\n        this.$message({\n          message: \"flag 不能为空\",\n          type: \"error\"\n        })\n        return\n      }\n      sceneFlag(this.layout.id, flag).then(response => {\n        this.loadingFlag = false\n        let rsp = response.data\n        let status = rsp.status\n        if (status === 200){\n          this.$message({\n            message:  \"恭喜！通过\",\n            type: \"success\",\n          })\n          this.flag = \"\"\n          this.handleRank(1)\n        }else{\n          this.$message({\n            message:rsp.msg,\n            type: \"error\"\n          })\n        }\n      }).catch(err =>{\n        this.loadingFlag = false\n        this.$message({\n          message: \"服务器内部错误\",\n          type: \"error\",\n        })\n      })\n    },\n    /**\n     * 初始化排行\n     */\n    handleRank(page){\n      this.loadingFlag = true\n      this.loadingText = \"排行初始化中\"\n      this.page.page = page\n      sceneRank(this.layout.id, page).then(response => {\n        this.loadingFlag = false\n        let rsp = response.data\n        this.page.total = rsp.count\n        this.rankList = rsp.result\n        // 当前进度\n        this.currentProgress = rsp.progress\n        // 当前排名\n        this.currentRank = rsp.current\n        // 当前分数\n        this.currentScore = rsp.score\n      }).catch(err => {\n        this.loadingFlag = false\n        this.$message({\n          message: \"服务器内部错误\",\n          type: 'error'\n        })\n      })\n    },\n    computeTableIndex(index){\n      return (this.page.page - 1) * this.page.size + index + 1\n    }\n  }\n}\n</script>\n\n<style scoped>\n.text {\n  font-size: 14px;\n}\n\n.item {\n  margin-bottom: 18px;\n}\n.clearfix:before,\n.clearfix:after {\n  display: table;\n  content: \"\";\n}\n.clearfix:after {\n  clear: both\n}\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=f71d8ed6&scoped=true&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&id=f71d8ed6&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"f71d8ed6\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}